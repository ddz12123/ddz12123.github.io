"use strict";(globalThis.webpackChunkfontend_doc=globalThis.webpackChunkfontend_doc||[]).push([[1999],{9087:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>s});var o=r(6363);const i={},t=o.createContext(i);function c(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),o.createElement(t.Provider,{value:n},e.children)}},9306:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"\u524d\u7aef\u77e5\u8bc6\u5e93/Docker/vitepress\u90e8\u7f72","title":"vitepress \u90e8\u7f72","description":"1. Dockerfile","source":"@site/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Docker/vitepress\u90e8\u7f72.md","sourceDirName":"\u524d\u7aef\u77e5\u8bc6\u5e93/Docker","slug":"/\u524d\u7aef\u77e5\u8bc6\u5e93/Docker/vitepress\u90e8\u7f72","permalink":"/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Docker/vitepress\u90e8\u7f72","draft":false,"unlisted":false,"editUrl":"https://github.com/ddz12123/ddz12123.github.io/tree/main/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Docker/vitepress\u90e8\u7f72.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Docker Compose \u4f7f\u7528\u6307\u5357","permalink":"/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Docker/Docker Compose \u4f7f\u7528\u6307\u5357"},"next":{"title":"vue\u9879\u76eedocker\u90e8\u7f72","permalink":"/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Docker/vue\u9879\u76eedocker\u90e8\u7f72"}}');var i=r(7259),t=r(9087);const c={},s="vitepress \u90e8\u7f72",d={},a=[{value:"1. Dockerfile",id:"1-dockerfile",level:2},{value:"2. nginx.conf",id:"2-nginxconf",level:2},{value:"3. \u6784\u5efa\u811a\u672c",id:"3-\u6784\u5efa\u811a\u672c",level:2},{value:"3.1 build.sh",id:"31-buildsh",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"vitepress-\u90e8\u7f72",children:"vitepress \u90e8\u7f72"})}),"\n",(0,i.jsx)(n.h2,{id:"1-dockerfile",children:"1. Dockerfile"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:'# \u4f7f\u7528\u5b98\u65b9\u7684 Nginx \u955c\u50cf\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\r\nFROM nginx:alpine\r\n\r\n# \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55\r\nWORKDIR /app\r\n\r\n# \u5220\u9664\u9ed8\u8ba4\u7684 Nginx \u914d\u7f6e\u6587\u4ef6\r\nRUN rm /etc/nginx/conf.d/default.conf\r\n\r\n# \u590d\u5236\u81ea\u5b9a\u4e49\u7684 Nginx \u914d\u7f6e\u6587\u4ef6\r\nCOPY nginx.conf /etc/nginx/conf.d/\r\n\r\n# \u5c06\u6253\u5305\u540e\u7684\u9759\u6001\u6587\u4ef6\u590d\u5236\u5230 Nginx \u7684\u9ed8\u8ba4\u9759\u6001\u6587\u4ef6\u76ee\u5f55\r\nCOPY docs /usr/share/nginx/html\r\n\r\n# \u66b4\u9732\u7aef\u53e3\r\nEXPOSE 80\r\n\r\n# \u542f\u52a8 Nginx\r\nCMD ["nginx", "-g", "daemon off;"]\r\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"2-nginxconf",children:"2. nginx.conf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:'server {\r\n    gzip on;\r\n    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;\r\n\r\n    listen 80;\r\n    server_name _;\r\n    index index.html;\r\n\r\n    location / {\r\n        # content location\r\n        root /usr/share/nginx/html;\r\n\r\n        # exact matches -> reverse clean urls -> folders -> not found\r\n        try_files $uri $uri.html $uri/ =404;\r\n\r\n        # non existent pages\r\n        error_page 404 /404.html;\r\n\r\n        # a folder without index.html raises 403 in this setup\r\n        error_page 403 /404.html;\r\n\r\n        # adjust caching headers\r\n        # files in the assets folder have hashes filenames\r\n        location ~* ^/assets/ {\r\n            expires 1y;\r\n            add_header Cache-Control "public, immutable";\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"3-\u6784\u5efa\u811a\u672c",children:"3. \u6784\u5efa\u811a\u672c"}),"\n",(0,i.jsx)(n.h3,{id:"31-buildsh",children:"3.1 build.sh"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'#!/bin/bash\r\n#chmod +x build.sh\r\n\r\n# \u68c0\u67e5\u5e76\u5220\u9664\u65e7\u7684\u5bb9\u5668\r\nif [ "$(docker ps -a -q -f name=doc-web)" ]; then\r\n    echo "Stopping and removing existing container doc-web..."\r\n    docker stop doc-web\r\n    docker rm doc-web\r\nfi\r\n\r\n# \u68c0\u67e5\u5e76\u5220\u9664\u65e7\u7684\u955c\u50cf\r\nif [ "$(docker images -q doc-container)" ]; then\r\n    echo "Removing existing image doc-container..."\r\n    docker rmi doc-container\r\nfi\r\n\r\n# \u6784\u5efa Docker \u955c\u50cf\r\ndocker build -t doc-container .\r\n\r\n# \u8fd0\u884c Docker \u5bb9\u5668\u5e76\u6302\u8f7d\u76ee\u5f55\r\ndocker run -d -p 5000:80 --name doc-web -v /home/app/doc-web/docs:/usr/share/nginx/html doc-container\r\n\r\n# \u6253\u5370\u5bb9\u5668\u65e5\u5fd7\r\ndocker logs -f doc-web\r\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);