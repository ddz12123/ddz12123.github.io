"use strict";(globalThis.webpackChunkfontend_doc=globalThis.webpackChunkfontend_doc||[]).push([[2197],{8680:(r,n,e)=>{e.r(n),e.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>a,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/\u8bf7\u6c42\u5c01\u88c5","title":"uniapp \u8bf7\u6c42\u5c01\u88c5","description":"1. \u7b80\u6613\u7248\u672c","source":"@site/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/\u8bf7\u6c42\u5c01\u88c5.md","sourceDirName":"\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp","slug":"/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/\u8bf7\u6c42\u5c01\u88c5","permalink":"/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/\u8bf7\u6c42\u5c01\u88c5","draft":false,"unlisted":false,"editUrl":"https://github.com/ddz12123/ddz12123.github.io/tree/main/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/\u8bf7\u6c42\u5c01\u88c5.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"uniapp \u81ea\u5b9a\u4e49 tabbar","permalink":"/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/\u81ea\u5b9a\u4e49tabbar"}}');var o=e(7259),s=e(9087);const a={},i="uniapp \u8bf7\u6c42\u5c01\u88c5",c={},u=[{value:"1. \u7b80\u6613\u7248\u672c",id:"1-\u7b80\u6613\u7248\u672c",level:2},{value:"1.1 utils/request.js",id:"11-utilsrequestjs",level:3},{value:"2. \u4f7f\u7528\u793a\u4f8b",id:"2-\u4f7f\u7528\u793a\u4f8b",level:2},{value:"2.1 \u5728\u9875\u9762\u4e2d\u4f7f\u7528",id:"21-\u5728\u9875\u9762\u4e2d\u4f7f\u7528",level:3}];function d(r){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",...(0,s.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"uniapp-\u8bf7\u6c42\u5c01\u88c5",children:"uniapp \u8bf7\u6c42\u5c01\u88c5"})}),"\n",(0,o.jsx)(n.h2,{id:"1-\u7b80\u6613\u7248\u672c",children:"1. \u7b80\u6613\u7248\u672c"}),"\n",(0,o.jsx)(n.h3,{id:"11-utilsrequestjs",children:"1.1 utils/request.js"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// utils/request.js\r\n\r\nconst BASE_URL = 'https://example.com/api'; // \u4f60\u7684\u63a5\u53e3\u57fa\u7840\u8def\u5f84\r\n\r\n// \u62e6\u622a\u5668\u914d\u7f6e\r\nconst interceptors = {\r\n  // \u8bf7\u6c42\u62e6\u622a\r\n  request(config) {\r\n    // \u4f8b\u5982\uff1a\u6dfb\u52a0 token\r\n    const token = uni.getStorageSync('token');\r\n    if (token) {\r\n      config.header = {\r\n        ...config.header,\r\n        Authorization: `Bearer ${token}`,\r\n      };\r\n    }\r\n    return config;\r\n  },\r\n\r\n  // \u54cd\u5e94\u62e6\u622a\r\n  response(response) {\r\n    // \u53ef\u4ee5\u5728\u8fd9\u91cc\u505a\u7edf\u4e00\u9519\u8bef\u5904\u7406\r\n    const { statusCode, data } = response;\r\n    if (statusCode >= 200 && statusCode < 300) {\r\n      return data;\r\n    } else {\r\n      uni.showToast({\r\n        title: data?.message || '\u8bf7\u6c42\u9519\u8bef',\r\n        icon: 'none',\r\n      });\r\n      return Promise.reject(data);\r\n    }\r\n  },\r\n\r\n  // \u9519\u8bef\u62e6\u622a\uff08\u7f51\u7edc\u9519\u8bef\u3001\u8d85\u65f6\u7b49\uff09\r\n  error(error) {\r\n    uni.showToast({\r\n      title: '\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5',\r\n      icon: 'none',\r\n    });\r\n    return Promise.reject(error);\r\n  },\r\n};\r\n\r\n// \u901a\u7528\u8bf7\u6c42\u5c01\u88c5\r\nfunction request(options) {\r\n  const config = interceptors.request({\r\n    url: BASE_URL + options.url,\r\n    method: options.method || 'GET',\r\n    data: options.data || {},\r\n    header: options.header || {},\r\n    timeout: options.timeout || 10000,\r\n  });\r\n\r\n  return new Promise((resolve, reject) => {\r\n    uni.request({\r\n      ...config,\r\n      success: (res) => {\r\n        try {\r\n          const data = interceptors.response(res);\r\n          resolve(data);\r\n        } catch (err) {\r\n          reject(err);\r\n        }\r\n      },\r\n      fail: (err) => {\r\n        interceptors.error(err);\r\n        reject(err);\r\n      },\r\n    });\r\n  });\r\n}\r\n\r\n// \u5e38\u7528 CRUD \u5c01\u88c5\r\nconst http = {\r\n  get(url, params = {}, config = {}) {\r\n    return request({ url, method: 'GET', data: params, ...config });\r\n  },\r\n\r\n  post(url, data = {}, config = {}) {\r\n    return request({ url, method: 'POST', data, ...config });\r\n  },\r\n\r\n  put(url, data = {}, config = {}) {\r\n    return request({ url, method: 'PUT', data, ...config });\r\n  },\r\n\r\n  delete(url, data = {}, config = {}) {\r\n    return request({ url, method: 'DELETE', data, ...config });\r\n  },\r\n};\r\n\r\nexport default http;\r\n\n"})}),"\n",(0,o.jsx)(n.h2,{id:"2-\u4f7f\u7528\u793a\u4f8b",children:"2. \u4f7f\u7528\u793a\u4f8b"}),"\n",(0,o.jsx)(n.h3,{id:"21-\u5728\u9875\u9762\u4e2d\u4f7f\u7528",children:"2.1 \u5728\u9875\u9762\u4e2d\u4f7f\u7528"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// \u5728\u4efb\u610f\u9875\u9762\u6216\u6a21\u5757\u4e2d\u4f7f\u7528\r\nimport http from '@/utils/request.js';\r\n\r\nasync function loadData() {\r\n  try {\r\n    const res = await http.get('/user/list', { page: 1 });\r\n    console.log('\u7528\u6237\u5217\u8868\uff1a', res);\r\n  } catch (e) {\r\n    console.error('\u8bf7\u6c42\u5931\u8d25\uff1a', e);\r\n  }\r\n}\r\n\n"})})]})}function l(r={}){const{wrapper:n}={...(0,s.R)(),...r.components};return n?(0,o.jsx)(n,{...r,children:(0,o.jsx)(d,{...r})}):d(r)}},9087:(r,n,e)=>{e.d(n,{R:()=>a,x:()=>i});var t=e(6363);const o={},s=t.createContext(o);function a(r){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof r?r(n):{...n,...r}},[n,r])}function i(r){let n;return n=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:a(r.components),t.createElement(s.Provider,{value:n},r.children)}}}]);