"use strict";(globalThis.webpackChunkfontend_doc=globalThis.webpackChunkfontend_doc||[]).push([[9149],{981:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/uni-app\u9274\u6743","title":"Uni-app \u9274\u6743\u7cfb\u7edf","description":"Uni-app\u5b8c\u6574\u9274\u6743\u89e3\u51b3\u65b9\u6848\uff0c\u5305\u542b\u767b\u5f55\u9a8c\u8bc1\u3001\u6743\u9650\u63a7\u5236\u3001\u767d\u540d\u5355\u673a\u5236\u7b49\u6838\u5fc3\u529f\u80fd","source":"@site/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/uni-app\u9274\u6743.md","sourceDirName":"\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp","slug":"/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/uni-app\u9274\u6743","permalink":"/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/uni-app\u9274\u6743","draft":false,"unlisted":false,"editUrl":"https://github.com/ddz12123/ddz12123.github.io/tree/main/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/uni-app\u9274\u6743.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"description":"Uni-app\u5b8c\u6574\u9274\u6743\u89e3\u51b3\u65b9\u6848\uff0c\u5305\u542b\u767b\u5f55\u9a8c\u8bc1\u3001\u6743\u9650\u63a7\u5236\u3001\u767d\u540d\u5355\u673a\u5236\u7b49\u6838\u5fc3\u529f\u80fd","keywords":["Uni-app","\u9274\u6743","\u767b\u5f55\u9a8c\u8bc1","\u6743\u9650\u63a7\u5236","\u767d\u540d\u5355"]},"sidebar":"docs","previous":{"title":"\ud83d\udcbbUni-app\u8de8\u5e73\u53f0\u5f00\u53d1","permalink":"/docs/category/uniapp-development"},"next":{"title":"Uniapp \u5957\u58f3h5\u6253\u5305app","permalink":"/docs/\u524d\u7aef\u77e5\u8bc6\u5e93/Uniapp/Uniapp \u5957\u58f3h5\u6253\u5305app"}}');var i=e(7259),s=e(9087);const o={sidebar_position:1,description:"Uni-app\u5b8c\u6574\u9274\u6743\u89e3\u51b3\u65b9\u6848\uff0c\u5305\u542b\u767b\u5f55\u9a8c\u8bc1\u3001\u6743\u9650\u63a7\u5236\u3001\u767d\u540d\u5355\u673a\u5236\u7b49\u6838\u5fc3\u529f\u80fd",keywords:["Uni-app","\u9274\u6743","\u767b\u5f55\u9a8c\u8bc1","\u6743\u9650\u63a7\u5236","\u767d\u540d\u5355"]},l="Uni-app \u9274\u6743\u7cfb\u7edf",c={},a=[{value:"\ud83d\udccb \u6982\u8ff0",id:"-\u6982\u8ff0",level:2},{value:"\ud83c\udfaf \u6838\u5fc3\u529f\u80fd",id:"-\u6838\u5fc3\u529f\u80fd",level:3},{value:"\ud83d\udee0\ufe0f \u521b\u5efa\u9274\u6743\u5de5\u5177",id:"\ufe0f-\u521b\u5efa\u9274\u6743\u5de5\u5177",level:2},{value:"\ud83d\udcc1 1.1 \u521b\u5efa\u9274\u6743\u5de5\u5177\u6587\u4ef6",id:"-11-\u521b\u5efa\u9274\u6743\u5de5\u5177\u6587\u4ef6",level:3},{value:"\ud83d\ude80 \u4f7f\u7528\u793a\u4f8b",id:"-\u4f7f\u7528\u793a\u4f8b",level:2},{value:"\ud83d\udcf1 \u5728\u9875\u9762\u4e2d\u4f7f\u7528",id:"-\u5728\u9875\u9762\u4e2d\u4f7f\u7528",level:3},{value:"\ud83d\udcca \u6700\u4f73\u5b9e\u8df5",id:"-\u6700\u4f73\u5b9e\u8df5",level:2},{value:"\ud83c\udfaf 1. \u767d\u540d\u5355\u7ba1\u7406",id:"-1-\u767d\u540d\u5355\u7ba1\u7406",level:3},{value:"\ud83d\udd12 2. Token \u7ba1\u7406",id:"-2-token-\u7ba1\u7406",level:3},{value:"\ud83d\udee1\ufe0f 3. \u9519\u8bef\u5904\u7406",id:"\ufe0f-3-\u9519\u8bef\u5904\u7406",level:3},{value:"\ud83d\udccb \u5e38\u89c1\u95ee\u9898",id:"-\u5e38\u89c1\u95ee\u9898",level:2},{value:"\ud83d\udd17 \u76f8\u5173\u8d44\u6e90",id:"-\u76f8\u5173\u8d44\u6e90",level:2},{value:"\ud83d\udccb \u914d\u7f6e\u8bf4\u660e",id:"-\u914d\u7f6e\u8bf4\u660e",level:3},{value:"\ud83d\udd27 \u5168\u5c40\u6ce8\u518c\u9274\u6743",id:"-\u5168\u5c40\u6ce8\u518c\u9274\u6743",level:2},{value:"\ud83d\udcf1 2.1 \u5728 main.js \u4e2d\u6ce8\u518c\u5168\u5c40 mixin",id:"-21-\u5728-mainjs-\u4e2d\u6ce8\u518c\u5168\u5c40-mixin",level:3},{value:"\ud83c\udfaf \u591a\u7aef\u517c\u5bb9\u6027\u5904\u7406",id:"-\u591a\u7aef\u517c\u5bb9\u6027\u5904\u7406",level:3}];function d(n){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"uni-app-\u9274\u6743\u7cfb\u7edf",children:"Uni-app \u9274\u6743\u7cfb\u7edf"})}),"\n",(0,i.jsx)(r.h2,{id:"-\u6982\u8ff0",children:"\ud83d\udccb \u6982\u8ff0"}),"\n",(0,i.jsx)(r.p,{children:"\u5728 Uni-app \u5e94\u7528\u5f00\u53d1\u4e2d\uff0c\u9274\u6743\u662f\u4fdd\u969c\u5e94\u7528\u5b89\u5168\u7684\u91cd\u8981\u73af\u8282\u3002\u672c\u6307\u5357\u63d0\u4f9b\u4e00\u5957\u5b8c\u6574\u7684\u9274\u6743\u89e3\u51b3\u65b9\u6848\uff0c\u652f\u6301\u767b\u5f55\u9a8c\u8bc1\u3001\u6743\u9650\u63a7\u5236\u3001\u767d\u540d\u5355\u673a\u5236\u7b49\u6838\u5fc3\u529f\u80fd\u3002"}),"\n",(0,i.jsx)(r.h3,{id:"-\u6838\u5fc3\u529f\u80fd",children:"\ud83c\udfaf \u6838\u5fc3\u529f\u80fd"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"\u767b\u5f55\u72b6\u6001\u9a8c\u8bc1"}),"\uff1a\u81ea\u52a8\u68c0\u6d4b\u7528\u6237\u767b\u5f55\u72b6\u6001"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"\u9875\u9762\u6743\u9650\u63a7\u5236"}),"\uff1a\u57fa\u4e8e\u8def\u7531\u7684\u6743\u9650\u7ba1\u7406"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"\u767d\u540d\u5355\u673a\u5236"}),"\uff1a\u65e0\u9700\u767b\u5f55\u5373\u53ef\u8bbf\u95ee\u7684\u9875\u9762"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"\u81ea\u52a8\u8df3\u8f6c"}),"\uff1a\u672a\u767b\u5f55\u7528\u6237\u81ea\u52a8\u8df3\u8f6c\u5230\u767b\u5f55\u9875"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"\u591a\u7aef\u517c\u5bb9"}),"\uff1a\u652f\u6301 H5\u3001\u5c0f\u7a0b\u5e8f\u3001App \u7b49\u591a\u4e2a\u5e73\u53f0"]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"\ufe0f-\u521b\u5efa\u9274\u6743\u5de5\u5177",children:"\ud83d\udee0\ufe0f \u521b\u5efa\u9274\u6743\u5de5\u5177"}),"\n",(0,i.jsx)(r.h3,{id:"-11-\u521b\u5efa\u9274\u6743\u5de5\u5177\u6587\u4ef6",children:"\ud83d\udcc1 1.1 \u521b\u5efa\u9274\u6743\u5de5\u5177\u6587\u4ef6"}),"\n",(0,i.jsxs)(r.p,{children:["\u5728 ",(0,i.jsx)(r.code,{children:"utils/auth.js"})," \u4e2d\u521b\u5efa\u9274\u6743\u5de5\u5177\u7c7b\uff1a"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'title="utils/auth.js"',children:"/**\r\n * Uni-app \u9274\u6743\u5de5\u5177\u7c7b\r\n * \u63d0\u4f9b\u7528\u6237\u767b\u5f55\u72b6\u6001\u9a8c\u8bc1\u548c\u9875\u9762\u6743\u9650\u63a7\u5236\u529f\u80fd\r\n */\r\n\r\n// \u767d\u540d\u5355\u9875\u9762 - \u65e0\u9700\u767b\u5f55\u5373\u53ef\u8bbf\u95ee\r\nconst whiteList = [\r\n  '/pages/login/login',      // \u767b\u5f55\u9875\u9762\r\n  '/pages/register/register', // \u6ce8\u518c\u9875\u9762\r\n  '/pages/about/about',      // \u5173\u4e8e\u9875\u9762\r\n  '/pages/index/index',      // \u9996\u9875\r\n]\r\n\r\n/**\r\n * \u68c0\u67e5\u7528\u6237\u767b\u5f55\u72b6\u6001\r\n * @param {string} pagePath - \u9875\u9762\u8def\u5f84\r\n * @returns {boolean} - \u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\r\n */\r\nexport function checkAuth(pagePath) {\r\n  try {\r\n    // \u83b7\u53d6\u767b\u5f55\u4ee4\u724c\r\n    const token = uni.getStorageSync('token')\r\n    \r\n    // \u5982\u679c\u7528\u6237\u5df2\u767b\u5f55\uff0c\u76f4\u63a5\u8fd4\u56de true\r\n    if (token) {\r\n      return true\r\n    }\r\n    \r\n    // \u5982\u679c\u9875\u9762\u5728\u767d\u540d\u5355\u4e2d\uff0c\u5141\u8bb8\u8bbf\u95ee\r\n    if (whiteList.includes(pagePath)) {\r\n      return true\r\n    }\r\n    \r\n    // \u672a\u767b\u5f55\u4e14\u4e0d\u5728\u767d\u540d\u5355\uff0c\u8df3\u8f6c\u5230\u767b\u5f55\u9875\r\n    uni.showToast({\r\n      title: '\u8bf7\u5148\u767b\u5f55',\r\n      icon: 'none',\r\n      duration: 1500\r\n    })\r\n    \r\n    setTimeout(() => {\r\n      uni.redirectTo({\r\n        url: '/pages/login/login'\r\n      })\r\n    }, 1500)\r\n    \r\n    return false\r\n  } catch (error) {\r\n    console.error('\u9274\u6743\u68c0\u67e5\u5931\u8d25:', error)\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * \u83b7\u53d6\u7528\u6237\u4fe1\u606f\r\n * @returns {object|null} - \u7528\u6237\u4fe1\u606f\u6216 null\r\n */\r\nexport function getUserInfo() {\r\n  try {\r\n    const userInfo = uni.getStorageSync('userInfo')\r\n    return userInfo || null\r\n  } catch (error) {\r\n    console.error('\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25:', error)\r\n    return null\r\n  }\r\n}\r\n\r\n/**\r\n * \u4fdd\u5b58\u7528\u6237\u4fe1\u606f\r\n * @param {object} userInfo - \u7528\u6237\u4fe1\u606f\r\n */\r\nexport function setUserInfo(userInfo) {\r\n  try {\r\n    uni.setStorageSync('userInfo', userInfo)\r\n  } catch (error) {\r\n    console.error('\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\u5931\u8d25:', error)\r\n  }\r\n}\r\n\r\n/**\r\n * \u6e05\u9664\u7528\u6237\u4fe1\u606f\uff08\u9000\u51fa\u767b\u5f55\uff09\r\n */\r\nexport function clearUserInfo() {\r\n  try {\r\n    uni.removeStorageSync('token')\r\n    uni.removeStorageSync('userInfo')\r\n  } catch (error) {\r\n    console.error('\u6e05\u9664\u7528\u6237\u4fe1\u606f\u5931\u8d25:', error)\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"-\u4f7f\u7528\u793a\u4f8b",children:"\ud83d\ude80 \u4f7f\u7528\u793a\u4f8b"}),"\n",(0,i.jsx)(r.h3,{id:"-\u5728\u9875\u9762\u4e2d\u4f7f\u7528",children:"\ud83d\udcf1 \u5728\u9875\u9762\u4e2d\u4f7f\u7528"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-vue",metastring:'title="pages/profile/profile.vue"',children:'<template>\r\n  <view class="profile-container">\r\n    <view class="user-info" v-if="userInfo">\r\n      <text>\u6b22\u8fce, {{ userInfo.nickname }}</text>\r\n      <button @click="logout">\u9000\u51fa\u767b\u5f55</button>\r\n    </view>\r\n    <view class="login-prompt" v-else>\r\n      <text>\u8bf7\u5148\u767b\u5f55</text>\r\n      <button @click="goToLogin">\u53bb\u767b\u5f55</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { getUserInfo, clearUserInfo } from \'@/utils/auth.js\'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      userInfo: null\r\n    }\r\n  },\r\n  \r\n  onShow() {\r\n    // \u83b7\u53d6\u7528\u6237\u4fe1\u606f\r\n    this.userInfo = getUserInfo()\r\n  },\r\n  \r\n  methods: {\r\n    goToLogin() {\r\n      uni.navigateTo({\r\n        url: \'/pages/login/login\'\r\n      })\r\n    },\r\n    \r\n    logout() {\r\n      uni.showModal({\r\n        title: \'\u63d0\u793a\',\r\n        content: \'\u786e\u5b9a\u8981\u9000\u51fa\u767b\u5f55\u5417\uff1f\',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            // \u6e05\u9664\u7528\u6237\u4fe1\u606f\r\n            clearUserInfo()\r\n            \r\n            // \u8df3\u8f6c\u5230\u767b\u5f55\u9875\r\n            uni.redirectTo({\r\n              url: \'/pages/login/login\'\r\n            })\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n<\/script>\n'})}),"\n",(0,i.jsx)(r.h2,{id:"-\u6700\u4f73\u5b9e\u8df5",children:"\ud83d\udcca \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsx)(r.h3,{id:"-1-\u767d\u540d\u5355\u7ba1\u7406",children:"\ud83c\udfaf 1. \u767d\u540d\u5355\u7ba1\u7406"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",children:"// \u5efa\u8bae\u5c06\u767d\u540d\u5355\u914d\u7f6e\u5355\u72ec\u63d0\u53d6\u51fa\u6765\r\nexport const WHITE_LIST = [\r\n  '/pages/login/login',\r\n  '/pages/register/register',\r\n  '/pages/index/index',\r\n  '/pages/about/about',\r\n  '/pages/privacy/privacy', // \u9690\u79c1\u653f\u7b56\r\n  '/pages/terms/terms',     // \u7528\u6237\u534f\u8bae\r\n]\r\n\r\n// \u652f\u6301\u901a\u914d\u7b26\u7684\u767d\u540d\u5355\u68c0\u67e5\r\nexport function isInWhiteList(path) {\r\n  return WHITE_LIST.some(pattern => {\r\n    if (pattern.includes('*')) {\r\n      const regex = new RegExp(pattern.replace(/\\*/g, '.*'))\r\n      return regex.test(path)\r\n    }\r\n    return pattern === path\r\n  })\r\n}\n"})}),"\n",(0,i.jsx)(r.h3,{id:"-2-token-\u7ba1\u7406",children:"\ud83d\udd12 2. Token \u7ba1\u7406"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",children:"// \u5efa\u8bae\u5c01\u88c5 Token \u64cd\u4f5c\r\nconst TOKEN_KEY = 'user_token'\r\nconst TOKEN_EXPIRE = 7 * 24 * 60 * 60 * 1000 // 7\u5929\u6709\u6548\u671f\r\n\r\nexport function setToken(token) {\r\n  const expireTime = Date.now() + TOKEN_EXPIRE\r\n  uni.setStorageSync(TOKEN_KEY, token)\r\n  uni.setStorageSync('token_expire', expireTime)\r\n}\r\n\r\nexport function getToken() {\r\n  const token = uni.getStorageSync(TOKEN_KEY)\r\n  const expireTime = uni.getStorageSync('token_expire')\r\n  \r\n  if (!token || !expireTime) {\r\n    return null\r\n  }\r\n  \r\n  // \u68c0\u67e5\u662f\u5426\u8fc7\u671f\r\n  if (Date.now() > expireTime) {\r\n    removeToken()\r\n    return null\r\n  }\r\n  \r\n  return token\r\n}\r\n\r\nexport function removeToken() {\r\n  uni.removeStorageSync(TOKEN_KEY)\r\n  uni.removeStorageSync('token_expire')\r\n}\n"})}),"\n",(0,i.jsx)(r.h3,{id:"\ufe0f-3-\u9519\u8bef\u5904\u7406",children:"\ud83d\udee1\ufe0f 3. \u9519\u8bef\u5904\u7406"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",children:"// \u589e\u5f3a\u7684\u9519\u8bef\u5904\u7406\r\nexport function checkAuthWithError(pagePath) {\r\n  try {\r\n    const result = checkAuth(pagePath)\r\n    \r\n    if (!result) {\r\n      // \u8bb0\u5f55\u65e5\u5fd7\r\n      console.warn(`\u9274\u6743\u5931\u8d25 - \u9875\u9762: ${pagePath}, \u65f6\u95f4: ${new Date().toISOString()}`)\r\n      \r\n      // \u53ef\u4ee5\u5728\u8fd9\u91cc\u6dfb\u52a0\u57cb\u70b9\u7edf\u8ba1\r\n      // trackEvent('auth_failed', { page: pagePath })\r\n    }\r\n    \r\n    return result\r\n  } catch (error) {\r\n    console.error('\u9274\u6743\u68c0\u67e5\u5f02\u5e38:', error)\r\n    \r\n    // \u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u9ed8\u8ba4\u5141\u8bb8\u8bbf\u95ee\uff08\u964d\u7ea7\u5904\u7406\uff09\r\n    return true\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"-\u5e38\u89c1\u95ee\u9898",children:"\ud83d\udccb \u5e38\u89c1\u95ee\u9898"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"\u95ee\u9898"}),(0,i.jsx)(r.th,{children:"\u539f\u56e0"}),(0,i.jsx)(r.th,{children:"\u89e3\u51b3\u65b9\u6848"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"\u9274\u6743\u4e0d\u751f\u6548"}),(0,i.jsx)(r.td,{children:"mixin \u672a\u6b63\u786e\u6ce8\u518c"}),(0,i.jsx)(r.td,{children:"\u68c0\u67e5 main.js \u4e2d\u7684 mixin \u914d\u7f6e"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"\u9875\u9762\u8def\u5f84\u83b7\u53d6\u5931\u8d25"}),(0,i.jsx)(r.td,{children:"\u5e73\u53f0\u5dee\u5f02"}),(0,i.jsx)(r.td,{children:"\u4f7f\u7528\u5e73\u53f0\u68c0\u6d4b\u5de5\u5177\u517c\u5bb9\u5904\u7406"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Token \u4e22\u5931"}),(0,i.jsx)(r.td,{children:"\u5b58\u50a8\u5f02\u5e38"}),(0,i.jsx)(r.td,{children:"\u6dfb\u52a0\u5f02\u5e38\u5904\u7406\u548c\u964d\u7ea7\u65b9\u6848"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"\u8df3\u8f6c\u5931\u8d25"}),(0,i.jsx)(r.td,{children:"\u8def\u7531\u914d\u7f6e\u9519\u8bef"}),(0,i.jsx)(r.td,{children:"\u68c0\u67e5 pages.json \u914d\u7f6e"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"-\u76f8\u5173\u8d44\u6e90",children:"\ud83d\udd17 \u76f8\u5173\u8d44\u6e90"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://uniapp.dcloud.net.cn/",children:"Uni-app \u5b98\u65b9\u6587\u6863"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://uniapp.dcloud.net.cn/tutorial/page.html",children:"Uni-app \u8def\u7531\u6587\u6863"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://uniapp.dcloud.net.cn/api/storage/storage.html",children:"Uni-app \u5b58\u50a8 API"})}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"-\u914d\u7f6e\u8bf4\u660e",children:"\ud83d\udccb \u914d\u7f6e\u8bf4\u660e"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"\u914d\u7f6e\u9879"}),(0,i.jsx)(r.th,{children:"\u8bf4\u660e"}),(0,i.jsx)(r.th,{children:"\u793a\u4f8b"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"whiteList"})}),(0,i.jsx)(r.td,{children:"\u767d\u540d\u5355\u9875\u9762\u6570\u7ec4"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"['/pages/login/login']"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"checkAuth"})}),(0,i.jsx)(r.td,{children:"\u9274\u6743\u68c0\u67e5\u51fd\u6570"}),(0,i.jsxs)(r.td,{children:["\u8fd4\u56de ",(0,i.jsx)(r.code,{children:"boolean"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"getUserInfo"})}),(0,i.jsx)(r.td,{children:"\u83b7\u53d6\u7528\u6237\u4fe1\u606f"}),(0,i.jsx)(r.td,{children:"\u8fd4\u56de\u7528\u6237\u4fe1\u606f\u5bf9\u8c61"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"setUserInfo"})}),(0,i.jsx)(r.td,{children:"\u4fdd\u5b58\u7528\u6237\u4fe1\u606f"}),(0,i.jsx)(r.td,{children:"\u63a5\u6536\u7528\u6237\u4fe1\u606f\u5bf9\u8c61"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"-\u5168\u5c40\u6ce8\u518c\u9274\u6743",children:"\ud83d\udd27 \u5168\u5c40\u6ce8\u518c\u9274\u6743"}),"\n",(0,i.jsx)(r.h3,{id:"-21-\u5728-mainjs-\u4e2d\u6ce8\u518c\u5168\u5c40-mixin",children:"\ud83d\udcf1 2.1 \u5728 main.js \u4e2d\u6ce8\u518c\u5168\u5c40 mixin"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-js",metastring:'title="main.js"',children:"import { createSSRApp } from 'vue'\r\nimport App from './App.vue'\r\nimport { checkAuth } from '@/utils/auth.js'\r\n\r\nexport function createApp() {\r\n  const app = createSSRApp(App)\r\n\r\n  // \ud83d\udee1\ufe0f \u5168\u5c40\u9875\u9762\u9274\u6743 mixin\r\n  app.mixin({\r\n    onShow() {\r\n      try {\r\n        // \u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f\r\n        const pages = getCurrentPages()\r\n        if (!pages || pages.length === 0) {\r\n          console.warn('\u65e0\u6cd5\u83b7\u53d6\u9875\u9762\u4fe1\u606f')\r\n          return\r\n        }\r\n        \r\n        const currentPage = pages[pages.length - 1]\r\n        const path = '/' + currentPage.route\r\n        \r\n        console.log('\u5f53\u524d\u9875\u9762\u8def\u5f84:', path)\r\n        \r\n        // \u6267\u884c\u9274\u6743\u68c0\u67e5\r\n        checkAuth(path)\r\n      } catch (error) {\r\n        console.error('\u9875\u9762\u9274\u6743\u5931\u8d25:', error)\r\n      }\r\n    }\r\n  })\r\n\r\n  return { app }\r\n}\n"})}),"\n",(0,i.jsx)(r.h3,{id:"-\u591a\u7aef\u517c\u5bb9\u6027\u5904\u7406",children:"\ud83c\udfaf \u591a\u7aef\u517c\u5bb9\u6027\u5904\u7406"}),"\n",(0,i.jsx)(r.p,{children:"Uni-app \u652f\u6301\u591a\u4e2a\u5e73\u53f0\uff0c\u6211\u4eec\u9700\u8981\u786e\u4fdd\u4ee3\u7801\u5728\u5404\u7aef\u90fd\u80fd\u6b63\u5e38\u8fd0\u884c\uff1a"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'title="utils/platform.js"',children:"/**\r\n * \u5e73\u53f0\u68c0\u6d4b\u5de5\u5177\r\n */\r\nexport function getPlatform() {\r\n  // #ifdef H5\r\n  return 'h5'\r\n  // #endif\r\n  \r\n  // #ifdef MP-WEIXIN\r\n  return 'weixin'\r\n  // #endif\r\n  \r\n  // #ifdef MP-ALIPAY\r\n  return 'alipay'\r\n  // #endif\r\n  \r\n  // #ifdef APP-PLUS\r\n  return 'app'\r\n  // #endif\r\n  \r\n  // #ifdef MP-BAIDU\r\n  return 'baidu'\r\n  // #endif\r\n  \r\n  return 'unknown'\r\n}\r\n\r\n/**\r\n * \u662f\u5426\u652f\u6301 getCurrentPages\r\n */\r\nexport function supportGetCurrentPages() {\r\n  try {\r\n    const pages = getCurrentPages()\r\n    return Array.isArray(pages)\r\n  } catch (error) {\r\n    return false\r\n  }\r\n}\n"})})]})}function p(n={}){const{wrapper:r}={...(0,s.R)(),...n.components};return r?(0,i.jsx)(r,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},9087:(n,r,e)=>{e.d(r,{R:()=>o,x:()=>l});var t=e(6363);const i={},s=t.createContext(i);function o(n){const r=t.useContext(s);return t.useMemo(function(){return"function"==typeof n?n(r):{...r,...n}},[r,n])}function l(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:o(n.components),t.createElement(s.Provider,{value:r},n.children)}}}]);